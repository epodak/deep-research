---
marp: true
theme: am_blue
paginate: true
math: katex
headingDivider: [2,3,4,5]
backgroundColor: #D0E8D6DA
---
src/utils/deep-research.ts，`deep-research` 是一个用于实现深度研究的工具或框架，它通过一系列提示词（prompts）和结构化的数据处理来逐步推进研究过程。以下是其实现深度研究的步骤和对应的提示词逻辑：

### 1. **系统提示（System Prompt）**
系统提示词是整个研究过程的基础，它定义了研究者的角色和行为准则。`getSystemPrompt` 函数生成的提示词包括以下要点：
- 研究者是一个专家，当前日期是提示词生成的日期。
- 接受用户提供的信息，并假设其正确性。
- 不简化内容，提供详细、准确且有条理的回答。
- 提出用户未想到的解决方案，主动满足用户需求。
- 避免错误，确保回答的准确性和全面性。
- 重视论证而非权威来源，考虑新技术和非主流观点。
- 可以进行高水平的推测或预测，并明确标记。

这种系统提示词为后续的研究过程设定了基调，确保研究者以专业、全面且开放的态度进行研究。

### 2. **生成问题提示（Generate Questions Prompt）**
`generateQuestionsPrompt` 函数的作用是根据用户提供的初始查询（query），生成一系列跟进问题，以澄清研究方向。提示词的要点包括：
- 针对用户查询，提出至少5个跟进问题。
- 问题需要简洁明了，避免无关内容。

通过这种方式，研究者可以更好地理解用户的需求，为后续的研究提供更明确的方向。

### 3. **生成搜索引擎查询提示（Generate SERP Queries Prompt）**
`generateSerpQueriesPrompt` 函数根据用户查询生成一系列搜索引擎查询（SERP queries），用于进一步研究主题。提示词的要点包括：
- 基于用户查询，生成多个独特的搜索引擎查询。
- 每个查询需要有明确的研究目标，说明查询的目的以及如何利用查询结果推进研究。
- 输出必须符合指定的 JSON 模式。

这种提示词结构确保了研究者能够系统地探索主题的不同方面，并为后续研究提供清晰的路径。

### 4. **处理搜索结果提示（Process Search Result Prompt）**
`processSearchResultPrompt` 函数用于指导研究者如何处理搜索引擎返回的结果。提示词的要点包括：
- 使用指定的查询获取最新信息。
- 根据研究目标组织搜索结果。
- 提取关键信息，包括实体（如人物、地点、公司等）、具体数据和日期等。
- 生成的信息需要简洁、详细且信息密集，以便用于进一步研究。

这种提示词帮助研究者从大量信息中提取有价值的内容，并为后续研究提供基础。

### 5. **审查搜索引擎查询提示（Review SERP Queries Prompt）**
`reviewSerpQueriesPrompt` 函数用于根据用户建议和之前的发现，决定是否需要进一步研究。提示词的要点包括：
- 根据用户查询、之前的发现和用户建议，判断是否需要进一步研究。
- 如果需要进一步研究，生成新的搜索引擎查询。
- 输出必须符合指定的 JSON 模式。

这种提示词确保了研究过程的连贯性和逻辑性，避免重复研究或遗漏重要方向。

### 6. **撰写最终报告提示（Write Final Report Prompt）**
`writeFinalReportPrompt` 函数用于指导研究者根据之前的发现撰写最终报告。提示词的要点包括：
- 根据用户查询和之前的发现撰写详细报告。
- 报告应包含所有研究发现，目标是3页或以上。
- 报告应包含多样化的数据信息，如图片、公式、图表等，以 Markdown 语法呈现。

这种提示词确保了最终报告的全面性和专业性，同时利用 Markdown 语法提供丰富的视觉呈现。

### 总结
`deep-research` 通过一系列结构化的提示词逐步推进研究过程：
1. **系统提示**设定了研究的基本原则和态度。
2. **生成问题提示**帮助澄清研究方向。
3. **生成搜索引擎查询提示**用于系统性地探索主题。
4. **处理搜索结果提示**帮助提取有价值的信息。
5. **审查搜索引擎查询提示**决定是否需要进一步研究。
6. **撰写最终报告提示**确保报告的全面性和专业性。

这种逐步推进的方式确保了研究的深度和广度，同时通过结构化的提示词和 JSON 模式确保了研究过程的逻辑性和一致性。
